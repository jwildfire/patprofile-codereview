<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Patient profile for developers • pprofile</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Patient profile for developers">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pprofile</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/pprofile.html">Get started</a>
</li>
<li>
  <a href="../articles/pprofile_dev.html">patprofile for developers</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pprofile_dev.html">Patient profile for developers</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Patient profile for developers</h1>
            
            <h4 class="date">2019-08-27</h4>
      
      
      <div class="hidden name"><code>pprofile_dev.Rmd</code></div>

    </div>

    
    
<div id="adding-the-patient-profile-to-an-app" class="section level1">
<h1 class="hasAnchor">
<a href="#adding-the-patient-profile-to-an-app" class="anchor"></a>Adding the patient profile to an app</h1>
<p>The patient profile has been packaged as a <a href="https://shiny.rstudio.com/articles/modules.html">shiny module</a> to facilitate deployment. It can be added to any app that uses standard ADaM datasets with only a couple of lines.</p>
<div id="server" class="section level4">
<h4 class="hasAnchor">
<a href="#server" class="anchor"></a>Server</h4>
<p>Server side, ADaM datasets are passed in the module call.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">callModule</span>(patientProfile_mod, <span class="dt">id =</span> <span class="st">"pp_module1"</span>,
           <span class="dt">ADSL =</span> myADSL, <span class="dt">ADAE =</span> myADAE, <span class="dt">ADCM =</span> myADCM, <span class="dt">ADLB =</span> myADLB,
           <span class="dt">ADEG =</span> myADEG, <span class="dt">ADEX =</span> myADEX, <span class="dt">ADPC =</span> myADPC)</code></pre></div>
<p>Aside from <code>ADSL</code>, all other datasets can be left NULL. Missing datasets simply disable some of the functionalities of the module. Moreover, whenever informative columns are missing, the submodules will attempt to find alternative sources within the given data.</p>
</div>
<div id="ui" class="section level4">
<h4 class="hasAnchor">
<a href="#ui" class="anchor"></a>UI</h4>
<p>UI side, <code>patientProfile_modUI</code> can be used to</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/patientProfile_mod.html">patientProfile_modUI</a></span>(<span class="dt">id =</span> <span class="st">"pp_module1"</span>)</code></pre></div>
</div>
</div>
<div id="submodules" class="section level1">
<h1 class="hasAnchor">
<a href="#submodules" class="anchor"></a>Submodules</h1>
<p>While the patient profile is meant to be used as a single top level module that will adapt to the data available, submodules are exported by the package and can be used individually. They are currently impplemented as <code>tabPanel</code>, so their use is restricted to compatible containers (<code>navbarPage</code>/<code>avaNavbarPage</code>, <code>tabsetPanel</code>/<code>avaTabPanel</code>, …).</p>
<p>For example, to include the Exposure &amp; Lab values module alone</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Server</span>
<span class="kw">callModule</span>(<span class="dt">module =</span> exlb_mod, <span class="dt">id =</span> <span class="st">"exlb_auto"</span>, <span class="dt">uid =</span> uid,
           <span class="dt">ADSL =</span> ADSL, <span class="dt">ADLB =</span> ADLB, <span class="dt">ADEX =</span> ADEX, <span class="dt">ADPC =</span> ADPC)
<span class="co"># UI (within a tabset or menubar)</span>
<span class="kw"><a href="../reference/exlb_mod.html">exlb_UI</a></span>(<span class="kw">ns</span>(<span class="st">"exlb_auto"</span>))</code></pre></div>
<p>When used in this manner, it is the developer’s responsibility to add the appropritate data checks to ensure correct behaviour.</p>
<p>Refer to the individual submodules documentation for details on the required inputs.</p>
</div>
<div id="linking-patient-profile-with-other-modules" class="section level1">
<h1 class="hasAnchor">
<a href="#linking-patient-profile-with-other-modules" class="anchor"></a>Linking patient profile with other modules</h1>
<p>A <code>uid</code> argument can be passed to the patient profile. By creating a new input binding in the server code and linking it to a <code>Shiny.onInputChange</code> event, we can set the participant profile to automatically select a participant of interest targeted from another plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Server code</span>
uid &lt;-<span class="st"> </span><span class="kw">reactiveVal</span>()
<span class="kw">observe</span>({
  ns &lt;-<span class="st"> </span>session<span class="op">$</span>ns
  <span class="cf">if</span>(<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/NULL.html">is.null</a></span>(input<span class="op">$</span>patient_js)){
    <span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(<span class="st">"Updating selected patient"</span>)
    <span class="kw">uid</span>(input<span class="op">$</span>patient_selector)
  }
})
<span class="co"># Module call</span>
<span class="kw">callModule</span>(patientProfile_mod, <span class="dt">id =</span> <span class="st">"pp_module1"</span>, <span class="dt">uid =</span> uid, <span class="dt">ADSL =</span> myADSL)</code></pre></div>
<div id="existing-implementations" class="section level2">
<h2 class="hasAnchor">
<a href="#existing-implementations" class="anchor"></a>Existing implementations</h2>
<p>The <a href="http://go/scc/ase-pkg">AVA safety explorer</a> is linked with the patient profile, such that when a participant is clicked in the timelines or safety outlier explorer, the subject is pre-selected in the patient profile module.</p>
<p>Likewise, if the <a href="https://github.com/SafetyGraphics/hep-explorer">eDISH</a> plot is also part of the app, it will have the same interaction with the participant profile.</p>
</div>
<div id="custom-plots" class="section level2">
<h2 class="hasAnchor">
<a href="#custom-plots" class="anchor"></a>Custom plots</h2>
<p>An example is available in the <code>pp-template</code> shiny app embeded within the package.</p>
<p>Using plots from the <code>plotly</code> package and the <code>onRender</code> function of the <code>htmlwidgets</code> package, javascript code can be added to plot events. We can use this to link a custom plot with the patient profile</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># p is a plotly object</span>
p &lt;-<span class="st"> </span>p <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">onRender</span>(<span class="st">"</span>
<span class="st">  function(el){</span>
<span class="st">    el.on('plotly_click', function(d){</span>
<span class="st">      selsub = d.points[0].data.key[d.points[0].pointNumber];</span>
<span class="st">      console.log('Click: ', selsub);</span>
<span class="st">      Shiny.onInputChange('pp_module1-patient_js', selsub);</span>
<span class="st">    })</span>
<span class="st">  }</span>
<span class="st">"</span>)</code></pre></div>
<p>The chunk of code assume that the module id is “pp_module1”. If the module is named differently, the render string can be built</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">module_id &lt;-<span class="st"> "pp_module2"</span>
render &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"</span>
<span class="st">  function(el){</span>
<span class="st">    el.on('plotly_click', function(d){</span>
<span class="st">      selsub = d.points[0].data.key[d.points[0].pointNumber];</span>
<span class="st">      console.log('Click: ', selsub);</span>
<span class="st">      Shiny.onInputChange('"</span>, module_id, <span class="st">"-patient_js', selsub);</span>
<span class="st">    })</span>
<span class="st">  }</span>
<span class="st">"</span>)</code></pre></div>
<p>If the plot function is part of its own module, then the namespace must be passed instead of the module name.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">target &lt;-<span class="st"> </span><span class="kw">ns</span>(<span class="st">"patient_js"</span>)
render &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"</span>
<span class="st">  function(el){</span>
<span class="st">    el.on('plotly_click', function(d){</span>
<span class="st">      selsub = d.points[0].data.key[d.points[0].pointNumber];</span>
<span class="st">      console.log('Click: ', selsub);</span>
<span class="st">      Shiny.onInputChange('"</span>, target, <span class="st">"', selsub);</span>
<span class="st">    })</span>
<span class="st">  }</span>
<span class="st">"</span>)</code></pre></div>
</div>
</div>
<div id="creating-submodules-for-patprofile" class="section level1">
<h1 class="hasAnchor">
<a href="#creating-submodules-for-patprofile" class="anchor"></a>Creating submodules for patprofile</h1>
<p>All visualization tools were created as self contained submodules, making it trivial to extend the functionalities of the patient profile by adding new submodules.</p>
<p>Developers are encouraged to submit merge requests with their own shiny modules or open issues to suggest new visualization on the <a href="https://gitlabce.statwb.eu.novartis.net/SAUTERE1/pprofile">package’s GitLab page</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#adding-the-patient-profile-to-an-app">Adding the patient profile to an app</a></li>
      <li><a href="#submodules">Submodules</a></li>
      <li>
<a href="#linking-patient-profile-with-other-modules">Linking patient profile with other modules</a><ul class="nav nav-pills nav-stacked">
<li><a href="#existing-implementations">Existing implementations</a></li>
      <li><a href="#custom-plots">Custom plots</a></li>
      </ul>
</li>
      <li><a href="#creating-submodules-for-patprofile">Creating submodules for patprofile</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Renan Sauteraud, Xiao Ni.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.9100.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
